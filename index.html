<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Coffee Bloom Calendar Designer</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet" />
<style>
  :root {
      /* BRAND COLORS */
      --brown-primary: #5D4037;
      --brown-light: #8D6E63;
      --brown-bg: #FAF9F6;

      --green-primary: #2E5830;
      --green-light: #4A7A4D;
      --green-bg: #F4F7F4;

      /* Default variables (Villa) */
      --bg-color: var(--brown-bg);
      --text-primary: var(--brown-primary);
      --text-secondary: var(--brown-light);
      --accent-color: var(--brown-primary);
      --booked-color: #D7CCC8;
      --available-bg: #EFEBE9;
  }

  body { font-family: 'Montserrat', sans-serif; }
  .font-serif { font-family: 'Playfair Display', serif; }

  /* THEME: THE VILLA */
  body.theme-villa {
      --bg-color: var(--brown-bg);
      --text-primary: var(--brown-primary);
      --text-secondary: var(--brown-light);
      --accent-color: var(--brown-primary);
      --booked-color: #D7CCC8;
      --available-bg: #EFEBE9;
      --border-color: #E0E0E0;
  }

  /* THEME: THE VIEW */
  body.theme-view {
      --bg-color: var(--green-bg);
      --text-primary: var(--green-primary);
      --text-secondary: var(--green-light);
      --accent-color: var(--green-primary);
      --booked-color: #C8E6C9;
      --available-bg: #E8F5E9;
      --border-color: #E0E0E0;
  }

  /* CAPTURE AREA â€“ ONLY THIS PART IS IN THE PNG */
  #capture-area {
      aspect-ratio: 4/5;
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
      color: var(--text-primary);
      position: relative;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);

      background-color: rgba(0,0,0,0.25);
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;

      overflow: hidden;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
  }

  body.theme-villa #capture-area {
      background-image: url('coffeeblooms.jpeg');
  }
  body.theme-view #capture-area {
      background-image: url('coffeeblooms.jpeg');
  }

  /* TOP HALF BLUR OVERLAY */
  #capture-area::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(
          to bottom,
          rgba(255,255,255,0.85) 0%,
          rgba(255,255,255,0.65) 45%,
          rgba(255,255,255,0.00) 60%,
          rgba(255,255,255,0.00) 100%
        );
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      pointer-events: none;
      z-index: 0;
  }

  #capture-area > * {
      position: relative;
      z-index: 1;
  }

  .calendar-card {
      background-color: rgba(255, 255, 255, 0.86);
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 30px rgba(0,0,0,0.03);
      backdrop-filter: blur(5px);
  }

  .day-cell { transition: all 0.2s; border: 1px solid transparent; }
  .day-cell:hover { transform: scale(1.05); }

  .day-cell.available {
      background-color: var(--available-bg);
      color: var(--text-primary);
      font-weight: 600;
  }

  .day-cell.booked {
      background-color: transparent;
      color: #B0BEC5;
      text-decoration: line-through;
      opacity: 0.5;
      background-image: linear-gradient(135deg, transparent 48%, #B0BEC5 49%, #B0BEC5 51%, transparent 52%);
  }

  .tracking-ultra-wide { letter-spacing: 0.3em; }
  .tracking-mega-wide { letter-spacing: 0.5em; }

  @media (max-width: 640px) {
    body { padding: 1rem; }
    #capture-area {
      aspect-ratio: auto;
      padding: 1.5rem;
    }
    .calendar-card { padding: 1rem !important; }
  }
</style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8 flex flex-col items-center theme-villa">

<!-- CONTROLS -->
<div class="bg-white p-4 md:p-6 rounded-xl shadow-lg w-full max-w-2xl mb-6 md:mb-8 flex flex-col md:flex-row gap-4 md:gap-6 items-stretch md:items-center justify-between">
  <div class="flex flex-col gap-2 w-full md:w-auto">
    <label class="text-xs font-bold text-gray-500 uppercase tracking-wider">Select Month</label>
    <input type="month" id="monthPicker" class="border rounded-lg p-2 bg-gray-50 font-sans text-gray-700 focus:ring-2 focus:ring-amber-900 outline-none w-full">
  </div>

  <div class="flex gap-2 justify-between md:justify-center w-full md:w-auto">
    <button onclick="setTheme('villa')" class="flex-1 md:flex-none px-4 md:px-5 py-2 rounded-lg bg-[#5D4037] text-white text-sm md:text-base font-serif hover:opacity-90 transition shadow-sm">
      The Villa
    </button>
    <button onclick="setTheme('view')" class="flex-1 md:flex-none px-4 md:px-5 py-2 rounded-lg bg-[#2E5830] text-white text-sm md:text-base font-serif hover:opacity-90 transition shadow-sm">
      The View
    </button>
  </div>

  <button onclick="downloadImage()" class="w-full md:w-auto px-4 md:px-6 py-2 md:py-3 bg-gray-900 hover:bg-black text-white text-sm md:text-base font-bold rounded-lg shadow-md transition flex items-center justify-center gap-2">
    Download
  </button>
</div>

<!-- CAPTURED AREA -->
<div id="capture-area">

  <!-- Header -->
  <div class="text-center mt-2">
    <div class="mb-6 opacity-80">
      <div class="inline-block relative mb-2">
        <div class="text-xs font-bold tracking-[0.2em] border-b pb-1" style="border-color: var(--text-secondary);">COFFEE BLOOM</div>
        <div class="text-[8px] uppercase tracking-[0.3em] mt-1" style="color: var(--text-secondary);">ESTATES</div>
      </div>
    </div>

    <h1 id="propertyTitle" class="text-3xl md:text-5xl font-serif font-medium tracking-wide mb-2 uppercase" style="color: var(--text-primary);">THE VILLA</h1>
    <h2 id="propertySubTitle" class="text-[9px] md:text-[10px] font-sans uppercase tracking-[0.5em] font-medium opacity-70" style="color: var(--text-secondary);">V A D U V A N C H A L</h2>
  </div>

  <!-- Month Display -->
  <div class="flex justify-center items-center my-4 md:my-6">
    <div class="h-px w-10 md:w-12 bg-current opacity-20"></div>
    <div id="displayMonth" class="mx-3 md:mx-4 text-lg md:text-xl font-serif italic" style="color: var(--accent-color);">December 2025</div>
    <div class="h-px w-10 md:w-12 bg-current opacity-20"></div>
  </div>

  <!-- Calendar -->
  <div class="calendar-card p-4 md:p-6 rounded-sm flex-grow flex flex-col">
    <div class="grid grid-cols-7 mb-3 md:mb-4 text-center">
      <div class="text-[9px] font-bold uppercase opacity-40">Sun</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Mon</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Tue</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Wed</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Thu</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Fri</div>
      <div class="text-[9px] font-bold uppercase opacity-40">Sat</div>
    </div>

    <div id="calendarGrid" class="grid grid-cols-7 gap-1.5 md:gap-2 text-center flex-grow content-start">
      <!-- JS injected -->
    </div>
  </div>

</div>

<!-- FOOTER (NOT IN THE IMAGE) -->
<div class="w-full max-w-2xl mt-6 md:mt-8 text-center">
  <div class="flex justify-center gap-6 md:gap-8 text-[9px] font-bold uppercase tracking-widest mb-4 md:mb-6">
    <div class="flex items-center gap-2 opacity-40">
      <div class="w-1.5 h-1.5 rounded-full bg-gray-500"></div> Booked
    </div>
    <div class="flex items-center gap-2 text-[#2E5830]">
      <div class="w-1.5 h-1.5 rounded-full bg-current"></div> Available
    </div>
  </div>

  <div class="border-t pt-3 md:pt-4 opacity-80" style="border-color: rgba(0,0,0,0.1);">
    <div class="text-[9px] md:text-[10px] uppercase tracking-widest mb-1">Book Your Stay</div>
    <div class="text-sm md:text-base font-semibold tracking-wide">+91 89211 42220</div>
  </div>
</div>

<script>
  const grid = document.getElementById('calendarGrid');
  const monthPicker = document.getElementById('monthPicker');
  const displayMonth = document.getElementById('displayMonth');
  const propertyTitle = document.getElementById('propertyTitle');
  const propertySubTitle = document.getElementById('propertySubTitle');

  let currentDate = new Date();
  currentDate.setMonth(currentDate.getMonth() + 1);
  monthPicker.value = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;

  function loadSavedBookings() {
      const saved = localStorage.getItem('coffeeBloomBookings');
      if (saved) return JSON.parse(saved);
      return {};
  }

  function saveBookings(bookings) {
      localStorage.setItem('coffeeBloomBookings', JSON.stringify(bookings));
  }

  function isBooked(year, month, day, property) {
      const bookings = loadSavedBookings();
      const key = `${property}_${year}_${month}_${day}`;
      return bookings[key] === true;
  }

  function generateCalendar(year, month) {
      grid.innerHTML = '';
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const currentProperty = document.body.classList.contains('theme-view') ? 'view' : 'villa';

      const date = new Date(year, month, 1);
      displayMonth.textContent = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

      for (let i = 0; i < firstDay; i++) {
          const empty = document.createElement('div');
          grid.appendChild(empty);
      }

      for (let i = 1; i <= daysInMonth; i++) {
          const day = document.createElement('div');
          day.textContent = i;
          day.className = 'day-cell aspect-square flex items-center justify-center rounded-sm cursor-pointer text-[10px] md:text-xs select-none';

          if (isBooked(year, month, i, currentProperty)) {
              day.classList.add('booked');
          } else {
              day.classList.add('available');
          }

          day.onclick = () => toggleStatus(day, year, month, i);
          grid.appendChild(day);
      }
  }

  function toggleStatus(element, year, month, day) {
      const currentProperty = document.body.classList.contains('theme-view') ? 'view' : 'villa';
      const key = `${currentProperty}_${year}_${month}_${day}`;
      const bookings = loadSavedBookings();

      if (element.classList.contains('available')) {
          element.classList.remove('available');
          element.classList.add('booked');
          bookings[key] = true;
      } else {
          element.classList.remove('booked');
          element.classList.add('available');
          delete bookings[key];
      }
      saveBookings(bookings);
  }

  function setTheme(themeName) {
      document.body.className = `bg-gray-100 min-h-screen p-4 md:p-8 flex flex-col items-center theme-${themeName}`;

      if (themeName === 'villa') {
          propertyTitle.textContent = 'THE VILLA';
          propertySubTitle.textContent = 'V A D U V A N C H A L';
      } else {
          propertyTitle.textContent = 'THE VIEW';
          propertySubTitle.textContent = 'V A T T A T H U   V A Y A L';
      }

      const [y, m] = monthPicker.value.split('-');
      generateCalendar(parseInt(y), parseInt(m) - 1);
  }

  monthPicker.addEventListener('change', (e) => {
      const [y, m] = e.target.value.split('-');
      generateCalendar(parseInt(y), parseInt(m) - 1);
  });

  generateCalendar(currentDate.getFullYear(), currentDate.getMonth());

  function downloadImage() {
      const captureElement = document.getElementById('capture-area');
      const fileName = propertyTitle.textContent.replace(' ', '') + '_Availability.png';

      html2canvas(captureElement, {
          scale: 3,
          backgroundColor: null,
          useCORS: true,
          allowTaint: true
      }).then(canvas => {
          const link = document.createElement('a');
          link.download = fileName;
          link.href = canvas.toDataURL('image/png');
          link.click();
      });
  }

  function clearAllBookings() {
      if (confirm('Clear all booking data for both properties?')) {
          localStorage.removeItem('coffeeBloomBookings');
          const [y, m] = monthPicker.value.split('-');
          generateCalendar(parseInt(y), parseInt(m) - 1);
      }
  }
</script>
</body>
</html>
